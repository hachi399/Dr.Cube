<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Dr.Cube AIè§£æ / Team.ãã‚“ã¾ã¡ã‚ƒã‚“</title>
  <link rel="stylesheet" href="extremeStyle.css">
</head>

<body>
  <!-- ===== ã‚µã‚¤ãƒ‰ãƒãƒ¼ ===== -->
  <div id="sidebar" class="collapsed">
    <button id="toggleSidebar">â˜°</button>
    <div class="sidebar-content">
      <h2>é¸æŠã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ</h2>
      <div id="selected-text">ï¼ˆã¾ã é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼‰</div>

      <h2>AIè§£æçµæœ</h2>
      <div id="explanation">ãªãã£ãŸéƒ¨åˆ†ã®è§£æçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>

      <div id="footer">ğŸ§  AI Text Analyzer v0.2</div>
    </div>
  </div>

  <!-- ===== ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ===== -->
  <main id="main">
    <h1>Dr.Cube AIè§£æ / Team.ãã‚“ã¾ã¡ã‚ƒã‚“ /</h1>

    <div id="chat">
      <p>ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ</p>
    </div>

    <div class="chat-controls">
      <input id="input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." />
      <button id="sendBtn">é€ä¿¡</button>
    </div>

    <h3>ã‚«ãƒ¡ãƒ©æ˜ åƒ</h3>
    <button id="toggleBtn">â–¶ ã‚«ãƒ¡ãƒ©ON</button>
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas" style="display:none;"></canvas>

    <section id="content">
      <h2>AIè§£æãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</h2>
      <p>
        ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒšãƒ¼ã‚¸å†…ã®ã©ã“ã§ã‚‚ãƒ†ã‚­ã‚¹ãƒˆã‚’ãªãã‚‹ã“ã¨ã§ã€<br>
        ãã®æ„å‘³ã‚„èƒŒæ™¯ã‚’AIãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«è§£èª¬ã—ã¾ã™ã€‚
      </p>
      <p>
        ä¾‹ãˆã°ã€Œãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã€Œé‡å­AIã€ã€Œãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã€ãªã©ã‚’é¸æŠã—ã¦ã¿ã¦ãã ã•ã„ã€‚
      </p>
    </section>
  </main>

  <script src="keep_server.js"></script>
  <script src="mainscript.js"></script>
  <script>
    // ===== ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®é–‹é–‰ =====
    const sidebar = document.getElementById("sidebar");
    const toggleSidebar = document.getElementById("toggleSidebar");
    toggleSidebar.addEventListener("click", () => {
      sidebar.classList.toggle("collapsed");
      document.getElementById("main").classList.toggle("expanded");
    });

    // ===== é¸æŠãƒ†ã‚­ã‚¹ãƒˆã¨AIè§£æ =====
    const selectedBox = document.getElementById("selected-text");
    const explanationBox = document.getElementById("explanation");

    document.addEventListener("mouseup", async () => {
      const selectedText = window.getSelection().toString().trim();
      if (selectedText.length > 0) {
        selectedBox.textContent = selectedText;
        explanationBox.textContent = "è§£æä¸­... ğŸ”";

        try {
          const response = await fetch("https://dr-cube-1.onrender.com/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message: selectedText })
          });
          const data = await response.json();
          explanationBox.textContent = data.reply || "è§£æçµæœã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚";
        } catch (err) {
          explanationBox.textContent = "âš  ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚µãƒ¼ãƒãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚";
          console.error(err);
        }
      }
    });

    // ===== ãƒãƒ£ãƒƒãƒˆé€ä¿¡ =====
    document.getElementById("sendBtn").addEventListener("click", sendMessage);
  </script>
</body>
</html>
